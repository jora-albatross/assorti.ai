---
import type { CollectionEntry } from "astro:content";
const { recipe }: { recipe: CollectionEntry<"recipes"> } = Astro.props;
const d = recipe.data;

const href = `/recipes/${recipe.slug}`;
const imageSrc = d.preview ?? "/img/placeholder.png";
const imageAlt = d.imageAlt ?? `${d.title} â€“ preview`;
const titleId = `recipe-title-${recipe.slug}`;
---

<a 
href={href}
  aria-labelledby={titleId}
  class="group block overflow-hidden rounded-2xl border border-slate-200 bg-white transition
         hover:shadow-md focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/60"
>

  <!-- Image (prevents CLS with fixed ratio + width/height) -->

  <div class="aspect-[16/9] overflow-hidden bg-slate-100">
    <img
      src={imageSrc}
      alt={imageAlt}
      width="640"
      height="360"
      loading="lazy"
      decoding="async"
      sizes="(min-width:1024px) 33vw, 100vw"
      class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-[1.02]"
    />
  </div>

  <!-- Content -->
  <div class="p-6">
    <!-- Badges -->
    <div class="flex flex-wrap gap-2 text-xs">
      {d.category && (
        <span class="px-2 py-0.5 font-medium rounded-full bg-slate-100 text-secondary/80">
          {d.category}
        </span>
      )}
      {typeof d.eta !== "undefined" && (
        <span class="px-2 py-0.5 font-medium rounded-full bg-slate-100 text-secondary/80">
          {d.eta} min
        </span>
      )}
    </div>

    <!-- Title -->
    <h3 id={titleId} class="mt-3 text-[18px] leading-snug font-semibold text-secondary
                           transition-colors group-hover:text-primary">
      {d.title}
    </h3>

    <!-- Summary -->
    {d.summary && (
      <p class="mt-1 text-sm text-secondary/70 line-clamp-2">
        {d.summary}
      </p>
    )}

    <!-- Link affordance (the whole card is a link; this is just a visual cue) -->
    <span class="mt-4 inline-flex items-center gap-1 text-primary text-sm font-medium
                 group-hover:underline">
      Open
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" aria-hidden="true"
           class="transition-transform duration-200 group-hover:translate-x-0.5">
        <path d="M7 17L17 7M17 7H9M17 7v8" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="sr-only"> recipe: {d.title}</span>
    </span>
  </div>
</a>
